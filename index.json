[{"authors":["admin"],"categories":null,"content":"I am interested in the development, evaluation, and application of phylogenetic methods, using Bayesian statistics as an overarching framework and fossil as well as extant vertebrates as my primary model system. My current research projects include the development of a fast and flexible Bayesian method for estimating time-scaled supertrees, and an empirical study assessing the ability of environment-dependent birth-death models to yield insights into the diversification of coevolving clades.\nIn 2018, I started my PhD in Geophysical Sciences at the University of Chicago, where I joined the Slater Lab to work on fossil vertebrate phylogenetics and macroevolution. My previous research experience includes paleontological and ecological fieldwork in Poland and French Polynesia, a bioinformatics internship in the Kondrashov Lab at the Centre de Regulació Genòmica in Barcelona, Spain, and undergraduate research in the Alfaro Lab at UCLA.\n","date":1665307200,"expirydate":-62135596800,"kind":"taxonomy","lang":"en","lastmod":1665307200,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"/authors/admin/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/authors/admin/","section":"authors","summary":"I am interested in the development, evaluation, and application of phylogenetic methods, using Bayesian statistics as an overarching framework and fossil as well as extant vertebrates as my primary model system. My current research projects include the development of a fast and flexible Bayesian method for estimating time-scaled supertrees, and an empirical study assessing the ability of environment-dependent birth-death models to yield insights into the diversification of coevolving clades.\nIn 2018, I started my PhD in Geophysical Sciences at the University of Chicago, where I joined the Slater Lab to work on fossil vertebrate phylogenetics and macroevolution.","tags":null,"title":"David Černý","type":"authors"},{"authors":["David Černý"],"categories":null,"content":"","date":1665307200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1665307200,"objectID":"b946437f1fa53cafff34c8ec5ca00101","permalink":"/talk/gsa_2022/","publishdate":"2022-10-20T21:00:00Z","relpermalink":"/talk/gsa_2022/","section":"talk","summary":"Since 2017, multiple studies have cast doubt on the traditional view of large-scale dinosaur phylogeny, according to which the long-necked, herbivorous sauropodomorphs and the ancestrally carnivorous theropods form a monophyletic group (Saurischia) to the exclusion of the “bird-hipped” ornithischians. Emerging alternatives to this traditional arrangement include a sister-group relationship between Ornithischia and Sauropodomorpha (Ornithischiformes); a topology in which the ornithischians are sister to, or even nested within, Theropoda (Ornithoscelida); and the inclusion of the putatively non-dinosaurian Silesauridae within Ornithischia. Some (though not all) of these hypotheses have received support from formal phylogenetic analyses, a fact that has been often attributed to character coding differences among the underlying datasets. However, following a common practice within the parsimony phylogenetic framework, such analyses usually each produced a single point estimate of dinosaurian phylogeny, without determining whether it explained observed character data significantly better than the competing hypotheses. Moreover, despite the fact that improved congruence between phylogeny and stratigraphy has been put forward as a key piece of evidence in favor of some of the recently proposed non-standard hypotheses, none of the analyses performed so far has allowed stratigraphic ages to inform phylogenetic inference. Here, I address both of these shortcomings by taking advantage of the tools recently made available in the RevBayes phylogenetic software package, and conduct extensive Bayes factor model comparisons among 20 alternative phylogenetic topologies in both time-free and tip-dated settings. By repeating the comparisons on three recently published datasets that have produced discordant parsimony point estimates, I also show how this approach can be extended to evaluate the relative contributions of character scoring changes and stratigraphic information to the preference for competing early dinosaur topologies. The results obtained here highlight the importance of explicit hypothesis testing in modern morphological phylogenetics, and of integrating character data and stratigraphic evidence in a single coherent statistical framework.\n","tags":[],"title":"Relative impact of character coding differences and stratigraphic information on the support for alternative early dinosaur phylogenies","type":"talk"},{"authors":["David Černý","Rossy Natale"],"categories":null,"content":"","date":1661644800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1661644800,"objectID":"2563efc12fa85dd053cdd2df6ce50894","permalink":"/publication/cerny_et_natale_2022/","publishdate":"2022-10-15T20:30:00Z","relpermalink":"/publication/cerny_et_natale_2022/","section":"publication","summary":"Shorebirds (Charadriiformes) are a globally distributed clade of modern birds and, due to their ecological and morphological disparity, a frequent subject of comparative studies. While molecular phylogenies have been key to establishing the suprafamilial backbone of the charadriiform tree, a number of relationships at both deep and shallow taxonomic levels remain poorly resolved. The timescale of shorebird evolution also remains uncertain as a result of extensive disagreements among the published divergence dating studies, stemming largely from different choices of fossil calibrations. Here, we present the most comprehensive non-supertree phylogeny of shorebirds to date, based on a total-evidence dataset comprising 353 ingroup taxa (90% of all extant or recently extinct species), 27 loci (15 mitochondrial and 12 nuclear), and 69 morphological characters. We further clarify the timeline of charadriiform evolution by time-scaling this phylogeny using a set of 14 up-to-date and thoroughly vetted fossil calibrations. In addition, we assemble a taxonomically restricted 100-locus dataset specifically designed to resolve outstanding problems in higher-level charadriiform phylogeny. In terms of tree topology, our results are largely congruent with previous studies but indicate that some of the conflicts among earlier analyses reflect a genuine signal of pervasive gene tree discordance. Monophyly of the plovers (Charadriidae), the position of the ibisbill (_Ibidorhyncha_), and the relationships among the five subfamilies of the gulls (Laridae) could not be resolved even with greatly increased locus and taxon sampling. Moreover, several localized regions of uncertainty persist in shallower parts of the tree, including the interrelationships of the true auks (Alcinae) and anarhynchine plovers. Our node-dating and macroevolutionary rate analyses find support for a Paleocene origin of crown-group shorebirds, as well as exceptionally rapid recent radiations of Old World oystercatchers (Haematopodidae) and select genera of gulls. Our study underscores the challenges involved in estimating a comprehensively sampled and carefully calibrated time tree for a diverse avian clade, and highlights areas in need of further research.\n","tags":["Phylogeny","Birds","Charadriiformes","Fossil calibrations","Macroevolution"],"title":"Comprehensive taxon sampling and vetted fossils help clarify the time tree of shorebirds (Aves, Charadriiformes)","type":"publication"},{"authors":["David Černý","Rossy Natale"],"categories":null,"content":"","date":1624291200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1624291200,"objectID":"fabcfec67fa6f857260f2692ecfaeba4","permalink":"/talk/evolution_2021/","publishdate":"2021-08-13T16:00:00Z","relpermalink":"/talk/evolution_2021/","section":"talk","summary":"Shorebirds (Aves: Charadriiformes) represent one of the most species-rich orders of non-passerine birds, and their ecomorphological disparity has inspired a number of comparative studies. However, the lack of a reliably time-calibrated and taxonomically comprehensive phylogeny for the clade as a whole has impeded efforts to extend such studies to the ordinal level. Previous estimates of the age of the charadriiform crown group have ranged from the Early Cretaceous to the late Eocene, in both cases contradicting the known fossil record. Here, we present a total-evidence charadriiform phylogeny containing 336 species (~89% of the extant diversity) based on a 24-locus supermatrix and 69 morphological characters. We estimated divergence times on the fixed total-evidence topology using MCMCTree, a subset of 8 clock-like loci, and 16 extensively vetted fossil calibrations. The autocorrelated and uncorrelated relaxed clock models both place the origin of the charadriiform crown group in the Paleocene (95% HPD: 55.0--63.0 and 59.3--64.8 Ma, respectively), consistent with the known fossil record, but differ with regard to the timing of the seagull radiation (Larinae). This difference propagates into downstream analyses of diversification rates, causing BAMM to infer a speciation rate shift on the uncorrelated-rates tree but not the autocorrelated-rates tree favored by Bayes factor comparisons. Contrary to some previous findings, our results suggest that investigating the sensitivity of macroevolutionary rate estimates to the modeling assumptions made in time tree inference is essential for establishing the tempo and mode of clade evolution.\n","tags":[],"title":"Vetted calibrations and comprehensive taxon sampling clarify the timescale of shorebird evolution","type":"talk"},{"authors":["David Černý","Daniel Madzia","Graham J. Slater"],"categories":null,"content":"","date":1623283200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1623283200,"objectID":"66f16a4177c11b9ee9e16ec4c240e6e5","permalink":"/publication/cerny_et_al_2021/","publishdate":"2019-06-12T20:00:00Z","relpermalink":"/publication/cerny_et_al_2021/","section":"publication","summary":"Changes in speciation and extinction rates are key to the dynamics of clade diversification, but attempts to infer them from phylogenies of extant species face challenges. Methods capable of synthesizing information from extant and fossil species have yielded novel insights into diversification rate variation through time, but little is known about their behavior when analyzing entirely extinct clades. Here, we use empirical and simulated data to assess how two popular methods, PyRate and Fossil BAMM, perform in this setting. We inferred the first tip-dated trees for ornithischian dinosaurs, and combined them with fossil occurrence data to test whether the clade underwent an end-Cretaceous decline. We then simulated phylogenies and fossil records under empirical constraints to determine whether macroevolutionary and preservation rates can be teased apart under paleobiologically realistic conditions. We obtained discordant inferences about ornithischian macroevolution including a long-term speciation rate decline (BAMM), mostly flat rates with a steep diversification drop (PyRate) or without one (BAMM), and episodes of implausibly accelerated speciation and extinction (PyRate). Simulations revealed little to no conflation between speciation and preservation, but yielded spuriously correlated speciation and extinction estimates while time-smearing tree-wide shifts (BAMM) or overestimating their number (PyRate). Our results indicate that the small phylogenetic datasets available to vertebrate paleontologists and the assumptions made by current model-based methods combine to yield potentially unreliable inferences about the diversification of extinct clades. We provide guidelines for interpreting the results of the existing approaches in light of their limitations, and suggest how the latter may be mitigated.\n","tags":["BAMM","diversification","fossils","macroevolutionary rates","Ornithischia","PyRate"],"title":"Empirical and methodological challenges to the model-based inference of diversification rates in extinct clades","type":"publication"},{"authors":["David Černý"],"categories":["R"],"content":" The summary of the posterior from a Bayesian tip-dating analysis – e.g., the maximum clade credibility tree computed by TreeAnnotator from a BEAST 2 posterior – usually provides a whole wealth of information to the user, and while barebones, quick-and-dirty plotting of the results using FigTree or plot.phylo() is good enough for assessing whether the results are reasonable or not, it definitely doesn’t provide publication-quality figures. Below, I’ll try to show how such figures can be made by combining several existing R packages.\nStarting point: strap The geoscalePhylo() function from the strap package (Bell \u0026amp; Lloyd 2014) is well-known and widely used. It plots a time tree against a nice colorful timescale (the colors are the official color codes of the Commission for the Geological Map of the World), and includes other niceties inherited from plot.phylo(), such as automatically stripping tip names of underscores and printing them in italics. One of the cool options we have at our disposal with geoscalePhylo() is to visualize the uncertainty in the ages of not just the internal nodes (we do that further down below), but also the tips. We can do that using an age range table like the one below:\nNote: As pointed out on Facebook by David Bapst, the ages argument of geoscalePhylo() serves primarily for visualizing taxon durations in the fossil record; i.e., the time intervals between the first and last appearance. If a taxon is only known from a single stratigraphically unique occurrence, its first and last appearance will coincide; however, the age uncertainty associated with that occurrence can still be usefully represented using a range. This is what we’re doing below.\nage_table \u0026lt;- read.table(\u0026quot;~/age_ranges.txt\u0026quot;, stringsAsFactors = F) head(age_table) ## V1 V2 V3 ## 1 Abrictosaurus_consors 190.8 201.3 ## 2 Agilisaurus_louderbacki 163.5 170.3 ## 3 Albalophosaurus_yamaguchiorum 132.9 139.8 ## 4 Aquilops_americanus 99.6 109.0 ## 5 Archaeoceratops_oshimai 113.0 129.4 ## 6 Auroraceratops_rugosus 100.5 129.4 We need to reshuffle our age range table a bit, since geoscalePhylo() needs a matrix whose first and last appearance dates are in the right order, and which has exactly the right column and row names:\nif(!require(\u0026quot;phytools\u0026quot;)) {install.packages(\u0026quot;phytools\u0026quot;)} if(!require(\u0026quot;strap\u0026quot;)) {install.packages(\u0026quot;strap\u0026quot;)} library(phytools) library(strap) my_ages \u0026lt;- cbind(as.numeric(age_table[,3]), as.numeric(age_table[,2])) colnames(my_ages) \u0026lt;- c(\u0026quot;FAD\u0026quot;, \u0026quot;LAD\u0026quot;) rownames(my_ages) \u0026lt;- age_table[,1] tree \u0026lt;- read.nexus(\u0026quot;~/my_MCC_tree.tre\u0026quot;) # geoscalePhylo() needs the $root.time element for plotting tree$root.time \u0026lt;- max(nodeHeights(tree)) + 66.0 geoscalePhylo(ladderize(tree, right = F), ages = my_ages, x.lim = c(0, 240), cex.tip = 0.7, cex.age = 1.3, cex.ts = 1) Internally, geoscalePhylo() calls the plot.phylo() function bundled with ape, and so it accepts all of the latter’s arguments. We can make use of this to highlight clades.\nLet’s assume that we have a list where each clade to be highlighted gets a pair of “anchors”, whose MRCA is also the MRCA of the entire clade – like this one:\nmy_dino_list \u0026lt;- list(c(\u0026quot;Abrictosaurus_consors\u0026quot;, \u0026quot;Tianyulong_confuciusi\u0026quot;), c(\u0026quot;Goyocephale_lattimorei\u0026quot;, \u0026quot;Wannanosaurus_yansiensis_\u0026quot;), c(\u0026quot;Camptosaurus_dispar\u0026quot;, \u0026quot;Dryosaurus_altus_\u0026quot;), c(\u0026quot;Changchunsaurus_parvus\u0026quot;, \u0026quot;Hypsilophodon_foxii_\u0026quot;), c(\u0026quot;Aquilops_americanus\u0026quot;, \u0026quot;Xuanhuaceratops_niei\u0026quot;), c(\u0026quot;Euoplocephalus_tutus\u0026quot;, \u0026quot;Gargoyleosaurus_parkpinorum\u0026quot;), c(\u0026quot;Hesperosaurus_mjosi\u0026quot;, \u0026quot;Isaberrysaura_mollensis\u0026quot;)) What we want to do is (1) find the MRCA of each vector of tip names in the list, (2) assign a certain color to all tips descended from that node, and (3) assign the same color to all branches descended from it. The former is pretty easy:\ntip.coloring \u0026lt;- function(tree, clade_list, group_cols) { cols \u0026lt;- rep(\u0026quot;black\u0026quot;, length(tree$tip.label)) for(i in 1:length(clade_list)) { clade_mrca \u0026lt;- getMRCA(tree, clade_list[[i]]) all_dscndn \u0026lt;- phytools::getDescendants(tree, clade_mrca) tips_only \u0026lt;- all_dscndn[all_dscndn \u0026lt;= Ntip(tree)] cols[tips_only] \u0026lt;- group_cols[i] } return(cols) } Here, we are assuming that the user specifies which color to assign to which clade, rather than creating the colors within the function itself. An additional step is involved when we need to filter the descendant nodes down to tips only: we could get rid of it by using a different function, like Descendants() from phangorn (Schliep 2010), which takes node type as an argument. Here, we exploit the fact that in many of the R packages dealing with phylogenetic trees, the default node labeling scheme assigns numbers from 1 to \\(n\\) to the tips (leaves), \\(n+1\\) to the root, and \\(n+2\\) thru \\(2n-1\\) to the remaining internal nodes. Conversely, we can count on the fact that nodes labeled with numbers less than or equal to \\(n\\) are the tips.\nThe step that consists of coloring all branches descended from the same MRCA is more involved. Fortunately, the indefatigable Liam Revell provides code that does just that in one of the posts on his excellent phytools blog.\nHere, we simply package that code into a function analogous to the one shown above:\nbranch.coloring \u0026lt;- function(tree, clade_list, group_cols) { cols \u0026lt;- rep(\u0026quot;black\u0026quot;, nrow(tree$edge)) for(i in 1:length(clade_list)) { clade_mrca \u0026lt;- getMRCA(tree, clade_list[[i]]) all_dscndn \u0026lt;- phytools::getDescendants(tree, clade_mrca) cols[sapply(all_dscndn, function(x, y) which(y == x), y = tree$edge[,2])] \u0026lt;- group_cols[i] } return(cols) }  Adding HPDs: phyloch and weird loops The next thing we’d like to do than can’t be easily done using any of the many available geoscalePhylo arguments is to add 95% highest posterior density (HPD) intervals to the nodes of our tree.\nThe first step is to extract the necessary information from the annotated Nexus file produced by TreeAnnotator. There used to be several options for parsing such files; my favorite one was probably read.annotated.nexus() from the OutbreakTools library (Jombart et al. 2014), which unfortunately seems to have lately fallen victim to package dependency troubles. Nevertheless, the read.beast() function from the phyloch package (Heibl 2013) provides a great alternative. Note that we might want to define a new “annotation” (more accurately, add a new element to the list by which the tree is internally represented in R) that doesn’t care about how exactly we got our HPDs (from common ancestor heights? from median heights?) and that can be further manipulated:\nif(!require(\u0026quot;phyloch\u0026quot;)) { install.packages(\u0026quot;remotes\u0026quot;) remotes::install_github(\u0026quot;fmichonneau/phyloch\u0026quot;) } library(phyloch) annot_tree \u0026lt;- phyloch::read.beast(\u0026quot;~/my_MCC_tree.tre\u0026quot;) # If the Nexus file has common ancestor node heights in it, extract those; otherwise extract # the mean/median ones. if (is.null(annot_tree$`CAheight_95%_HPD_MIN`)) { annot_tree$min_ages \u0026lt;- annot_tree$`height_95%_HPD_MIN` annot_tree$max_ages \u0026lt;- annot_tree$`height_95%_HPD_MAX` } else { annot_tree$min_ages \u0026lt;- annot_tree$`CAheight_95%_HPD_MIN` annot_tree$max_ages \u0026lt;- annot_tree$`CAheight_95%_HPD_MAX` } We can also add an arbitrary offset to these ages without overriding the original annotations. Recently, a new class called TreeWOffset was introduced into BEAST 2 to store the age of the youngest tip. This comes in handy when our tree is entirely extinct, and we have age ranges associated with all tips including the youngest one(s). This class allows the ages of such tips to still be sampled from their ranges, effectively leading to the estimation of the “offset” of the tree from the present. Perhaps it is this offset that we want to add to the boundaries of our HPDs. Below, we assume that we have already summarized the posterior of all continuous parameters (including the offset) using LogAnalyser or a similar utility, and printed the results to a parsable text file. The TreeAnnotator-produced Nexus file is of no help here.\nparams \u0026lt;- read.table(\u0026quot;~/loganalyser_params.txt\u0026quot;, header = T, stringsAsFactors = F) # Check whether \u0026#39;offset\u0026#39; was actually used and logged: if (length(params$mean[params$statistic == \u0026quot;offset\u0026quot;] != 0)) { offset \u0026lt;- params$mean[params$statistic == \u0026quot;offset\u0026quot;] annot_tree$min_ages \u0026lt;- annot_tree$min_ages + offset annot_tree$max_ages \u0026lt;- annot_tree$max_ages + offset } The most complicated step consists of using this info to actually draw the HPDs – this is often done using half-transparent color bars – around the nodes. The basis for what we are going to do is again provided by Liam Revell.\nHowever, as we see below, our attempt to simply reuse the code given in the blog post does not produce satisfying results:\nannot_tree$root.time \u0026lt;- max(nodeHeights(annot_tree)) + 66.0 geoscalePhylo(ladderize(annot_tree, right = F), x.lim = c(20, 240), cex.tip = 0.7, cex.age = 1.3, cex.ts = 1) T1 \u0026lt;- get(\u0026quot;last_plot.phylo\u0026quot;, envir = .PlotPhyloEnv) for(i in (Ntip(annot_tree) + 1):(annot_tree$Nnode + Ntip(annot_tree))) { lines(x = c(annot_tree$min_ages[i - Ntip(annot_tree)], annot_tree$max_ages[i - Ntip(annot_tree)]), y = rep(T1$yy[i], 2), lwd = 6, lend = 0, col = make.transparent(\u0026quot;blue\u0026quot;, 0.4)) } Yes, our HPDs are clearly horrifyingly wide, but they are also not associated with the right nodes – in fact, they are not associated with any nodes, and instead just float freely over the tree. What’s going on here?\nThe answer is that the HPDs are reflected about a vertical axis in the middle of the plot. It turns out that we need to subtract both of their endpoints from the root age to fix this:\ngeoscalePhylo(ladderize(annot_tree, right = F), x.lim = c(20, 240), cex.tip = 0.7, cex.age = 1.3, cex.ts = 1) T1 \u0026lt;- get(\u0026quot;last_plot.phylo\u0026quot;, envir = .PlotPhyloEnv) for(i in (Ntip(annot_tree) + 1):(annot_tree$Nnode + Ntip(annot_tree))) { lines(x = c(T1$root.time - annot_tree$min_ages[i - Ntip(annot_tree)], T1$root.time - annot_tree$max_ages[i - Ntip(annot_tree)]), y = rep(T1$yy[i], 2), lwd = 6, lend = 0, col = make.transparent(\u0026quot;blue\u0026quot;, 0.4)) } Much better!\n Putting it all together Aside from what we went over above, the function below also parameterizes at what ages to start and stop plotting (so far we’ve been using fixed values for these), automatically draws the right number of colors to highlight clades with from the good-looking viridis palette, and annotates nodes with their posterior probabilities:\nif(!require(\u0026quot;viridis\u0026quot;)) {install.packages(\u0026quot;viridis\u0026quot;)} library(viridis) beast.plotter \u0026lt;- function(basepath, clade_list, xmin, xmax) { base_tree \u0026lt;- read.nexus(paste(basepath, \u0026quot;my_MCC_tree.tre\u0026quot;, sep = \u0026quot;\u0026quot;)) annot_tree \u0026lt;- phyloch::read.beast(paste(basepath, \u0026quot;my_MCC_tree.tre\u0026quot;, sep = \u0026quot;\u0026quot;)) age_table \u0026lt;- read.table(paste(basepath, \u0026quot;age_ranges.txt\u0026quot;, sep = \u0026quot;\u0026quot;), stringsAsFactors = F) params \u0026lt;- read.table(paste(basepath, \u0026quot;loganalyser_params.txt\u0026quot;, sep = \u0026quot;\u0026quot;), header = T, stringsAsFactors = F) if (is.null(annot_tree$`CAheight_95%_HPD_MIN`)) { annot_tree$min_ages \u0026lt;- annot_tree$`height_95%_HPD_MIN` annot_tree$max_ages \u0026lt;- annot_tree$`height_95%_HPD_MAX` } else { annot_tree$min_ages \u0026lt;- annot_tree$`CAheight_95%_HPD_MIN` annot_tree$max_ages \u0026lt;- annot_tree$`CAheight_95%_HPD_MAX` } base_tree$root.time \u0026lt;- max(nodeHeights(base_tree)) base_tree$node.label \u0026lt;- round(annot_tree$posterior, 2) if (length(params$mean[params$statistic == \u0026quot;offset\u0026quot;] != 0)) { offset \u0026lt;- params$mean[params$statistic == \u0026quot;offset\u0026quot;] base_tree$root.time \u0026lt;- base_tree$root.time + offset annot_tree$min_ages \u0026lt;- annot_tree$min_ages + offset annot_tree$max_ages \u0026lt;- annot_tree$max_ages + offset } else { base_tree$root.time \u0026lt;- base_tree$root.time + 66.0 annot_tree$min_ages \u0026lt;- annot_tree$min_ages + 66.0 annot_tree$max_ages \u0026lt;- annot_tree$max_ages + 66.0 } age_mat \u0026lt;- cbind(as.numeric(age_table[,3]), as.numeric(age_table[,2])) rownames(age_mat) \u0026lt;- age_table[,1] colnames(age_mat) \u0026lt;- c(\u0026quot;FAD\u0026quot;, \u0026quot;LAD\u0026quot;) clade_cols \u0026lt;- viridis(length(clade_list), option = \u0026quot;D\u0026quot;) br_cols \u0026lt;- branch.coloring(ladderize(base_tree, right = F), clade_list, clade_cols) tip_cols \u0026lt;- tip.coloring(ladderize(base_tree, right = F), clade_list, clade_cols) geoscalePhylo(tree = ladderize(base_tree, right = F), ages = age_mat, units = c(\u0026quot;Period\u0026quot;, \u0026quot;Epoch\u0026quot;, \u0026quot;Age\u0026quot;), boxes = \u0026quot;Epoch\u0026quot;, cex.tip = 0.7, cex.age = 1.3, cex.ts = 1, width = 2, x.lim = c(xmin, xmax), edge.color = br_cols, tip.color = tip_cols) nodelabels(base_tree$node.label) T1 \u0026lt;- get(\u0026quot;last_plot.phylo\u0026quot;, envir = .PlotPhyloEnv) # Get shaded bars for the HPD intervals. Credit: # http://blog.phytools.org/2017/03/error-bars-on-divergence-times-on.html for(i in (Ntip(base_tree) + 1):(base_tree$Nnode + Ntip(base_tree))) { lines(x = c(T1$root.time - annot_tree$min_ages[i - Ntip(base_tree)], T1$root.time - annot_tree$max_ages[i - Ntip(base_tree)]), y = rep(T1$yy[i], 2), lwd = 6, lend = 0, col = make.transparent(\u0026quot;blue\u0026quot;, 0.4)) } } Let’s try it out!\nbeast.plotter(\u0026quot;~/\u0026quot;, my_dino_list, 10, 240)  Refs  Bell MA, Lloyd GT 2014 strap: an R package for plotting phylogenies against stratigraphy and assessing their stratigraphic congruence. Palaeontol 58(2)2: 379–389 Heibl C 2013 http://www.christophheibl.de/Rpackages.html. Accessed 2020-01-29 Jombart T, Aanensen DM, Baguelin M, Birrell P, Cauchemez S, Camacho A, Colijn C, Collins C, Cori A, Didelot X, Fraser C, Frost S, Hens N, Hugues J, Höhle M, Opatowski L, Rambaut A, Ratmann O, Soubeyrand S, Suchard MA, Wallinga J, Ypma R, Ferguson N 2014 OutbreakTools: a new platform for disease outbreak analysis using the R software. Epidemics 7: 28–34 Schliep KP 2010 phangorn: phylogenetic analysis in R. Bioinform 27(4): 592–593   ","date":1580248800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1580248800,"objectID":"bae2db8a4b3834a4e17887ab2b53016d","permalink":"/post/plotting_beast/","publishdate":"2020-01-28T22:00:00Z","relpermalink":"/post/plotting_beast/","section":"post","summary":"The summary of the posterior from a Bayesian tip-dating analysis – e.g., the maximum clade credibility tree computed by TreeAnnotator from a BEAST 2 posterior – usually provides a whole wealth of information to the user, and while barebones, quick-and-dirty plotting of the results using FigTree or plot.phylo() is good enough for assessing whether the results are reasonable or not, it definitely doesn’t provide publication-quality figures. Below, I’ll try to show how such figures can be made by combining several existing R packages.","tags":[],"title":"Visualizing BEAST 2 time trees","type":"post"},{"authors":["Matt Friedman","Kara L. Feilich","Hermione T. Beckett","Michael E. Alfaro","Brant C. Faircloth","David Černý","Masaki Miya","Thomas J. Near","Richard C. Harrington"],"categories":null,"content":"","date":1568160000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1568160000,"objectID":"b1f5808127743bc1610b97a099e7b2eb","permalink":"/publication/friedman_et_al_2019/","publishdate":"2019-11-23T20:45:00Z","relpermalink":"/publication/friedman_et_al_2019/","section":"publication","summary":"The fish clade Pelagiaria, which includes tunas as its most famous members, evolved remarkable morphological and ecological variety in a setting not generally considered conducive to diversification: the open ocean. Relationships within Pelagiaria have proven elusive due to short internodes subtending major lineages suggestive of rapid early divergences. Using a novel sequence dataset of over 1000 ultraconserved DNA elements (UCEs) for 94 of the 286 species of Pelagiaria (more than 70% of genera), we provide a time-calibrated phylogeny for this widely distributed clade. Some inferred relationships have clear precedents (e.g. the monophyly of ‘core’ Stromateoidei, and a clade comprising ‘Gempylidae’ and Trichiuridae), but others are unexpected despite strong support (e.g. Chiasmodontidae + *Tetragonurus*). Relaxed molecular clock analysis using node-based fossil calibrations estimates a latest Cretaceous origin for Pelagiaria, with crown-group families restricted to the Cenozoic. Estimated mean speciation rates decline from the origin of the group in the latest Cretaceous, although credible intervals for root and tip rates are broad and overlap in most cases, and there is higher-than-expected partitioning of body shape diversity (measured as fineness ratio) between clades concentrated during the Palaeocene–Eocene. By contrast, more direct measures of ecology show either no substantial deviation from a null model of diversification (diet) or patterns consistent with evolutionary constraint or high rates of recent change (depth habitat). Collectively, these results indicate a mosaic model of diversification. Pelagiarians show high morphological disparity and modest species richness compared to better-studied fish radiations in contrasting environments. However, this pattern is also apparent in other clades in open-ocean or deep-sea habitats, and suggests that comparative study of such groups might provide a more inclusive model of the evolution of diversity in fishes.\n","tags":["Vertebrate phylogenetics","Macroevolutionary patterns","Phylogenetic comparative methods","Divergence dating","UCEs"],"title":"A phylogenomic framework for pelagiarian fishes (Acanthomorpha: Percomorpha) highlights mosaic radiation in the open ocean","type":"publication"},{"authors":["David Černý","Daniel Madzia","Graham J. Slater"],"categories":null,"content":"","date":1561217400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1561217400,"objectID":"c9763ef7072decc6bbbfd4f236855223","permalink":"/talk/evolution_2019/","publishdate":"2019-11-23T21:00:00Z","relpermalink":"/talk/evolution_2019/","section":"talk","summary":"A number of methods have recently become available to infer rates of speciation and extinction from datasets containing or restricted to extinct taxa; however, their comparative performance remains largely unexplored. To investigate the congruence of the estimates of macroevolutionary rates produced by these approaches, we inferred tip-dated phylogenies of bird-hipped dinosaurs (Archosauria: Ornithischia) using the Sampled-Ancestor Fossilized Birth-Death (SA-FBD) process and two of the largest character matrices published to date (73 taxa and 255 characters; 69 taxa and 380 characters). Phylogeny-based diversification rate analyses were performed using the recently released \"fossil BAMM\" (BAMM v2.6) package and a SA-FBD epoch model in BEAST 2. Importantly, no rate shifts were identified in the BAMM analyses, with the posterior probability of the zero-shift configuration ranging from 0.49 to 0.68, and ornithischian evolution was characterized by a single tree-wide density-dependent mode of diversification. Given the high congruence between the prior and posterior rate shift number distributions, we speculate that these findings may be driven by the insufficient number of included tips. A comparison with PyRate, a related Bayesian approach that does not rely on time-calibrated phylogenies, is also presented. We urge caution when applying BAMM-type macroevolutionary analyses to wholly extinct clades, as even the most comprehensive datasets available for extensively studied groups may not be large enough to detect diversification rate shifts.\n","tags":[],"title":"Inferring macroevolutionary dynamics of extinct clades: a test using ‘bird-hipped’ dinosaurs (Ornithischia)","type":"talk"},{"authors":[],"categories":[],"content":" Welcome to Slides Academic\nFeatures  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides  Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E  Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)  Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = \\;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\nFragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne  Two  Three \nA fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears  Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view   Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links   night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links  Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026quot;/img/boards.jpg\u0026quot; \u0026gt;}} {{\u0026lt; slide background-color=\u0026quot;#0000FF\u0026quot; \u0026gt;}} {{\u0026lt; slide class=\u0026quot;my-style\u0026quot; \u0026gt;}}  Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }  Questions? Ask\nDocumentation\n","date":1549324800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1549324800,"objectID":"0e6de1a61aa83269ff13324f3167c1a9","permalink":"/slides/example/","publishdate":"2019-02-05T00:00:00Z","relpermalink":"/slides/example/","section":"slides","summary":"An introduction to using Academic's Slides feature.","tags":[],"title":"Slides","type":"slides"},{"authors":["David Černý","Kristen Lee","Jocelyn Medal","Daniel T. Blumstein"],"categories":null,"content":"","date":1545350400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1545350400,"objectID":"ebe99e8e5179a3a0749c387a424b30f8","permalink":"/publication/cerny_et_al_2018/","publishdate":"2019-11-23T20:30:00Z","relpermalink":"/publication/cerny_et_al_2018/","section":"publication","summary":"Lanchester’s laws of combat are a mathematical framework describing the relative contributions of individual fighting ability and group size to overall group fighting ability. Since 1993, several studies have attempted to apply this framework to interspecific dominance relationships between nonhuman animals. However, this prior work addressed only the corollaries of Lanchester’s laws rather than the laws themselves. Here, we directly test Lanchester’s linear and square law to explain interspecific competition of coral reef fish. First, we analyzed the relationship between body size and dominance to find a biologically accurate proxy of individual fighting ability. We then tested whether group fighting ability was linearly (linear law) or quadratically (square law) related to group size while accounting for the different fighting abilities of competing species. We found support for the linear law; however, both laws were outperformed by a simpler model that only included body size. After accounting for possible outliers and data limitations, we suggest that Lanchester’s linear law may prove useful for explaining interspecific competition in marine ecosystems.\n","tags":["Behavioral ecology","Phylogenetic comparative methods"],"title":"Applying Lanchester’s laws to the interspecific competition of coral reef fish","type":"publication"},{"authors":["Marcela G.M. Lima","José de Sousa e Silva-Júnior","David Černý","Janet C. Buckner","Alexandre Aleixo","Jonathan Chang","Jimmy Zheng","Michael E. Alfaro","Amely Martins","Anthony Di Fiore","Jean P. Boubli","Jessica W. Lynch Alfaro"],"categories":null,"content":"","date":1520812800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1520812800,"objectID":"f08dfc01de1ea99880130580321e9bc8","permalink":"/publication/lima_et_al_2018/","publishdate":"2019-11-23T20:15:00Z","relpermalink":"/publication/lima_et_al_2018/","section":"publication","summary":"Phylogenetic relationships amongst the robust capuchin monkeys (genus *Sapajus*) are poorly understood. Morphology-based taxonomies have recognized anywhere from one to twelve different species. The current IUCN (2017) classification lists eight robust capuchins: *S. xanthosternos*, *S. nigritus*, *S. robustus*, *S. flavius*, *S. libidinosus*, *S. cay*, *S. apella* and *S. macrocephalus*. Here, we assembled the first phylogenomic data set for *Sapajus* using ultra-conserved elements (UCEs) to reconstruct a capuchin phylogeny. All phylogenomic analyses strongly supported a deep divergence of *Sapajus* and *Cebus* clades within the capuchin monkeys, and provided support for *Sapajus nigritus*, *S. robustus* and *S. xanthosternos* as distinct species. However, the UCE phylogeny lumped the putative species *S. cay*, *S. libidinosus*, *S. apella*, *S. macrocephalus*, and *S. flavius* together as a single widespread lineage. A SNP phylogeny constructed from the UCE data was better resolved and recovered *S. flavius* and *S. libidinosus* as sister species; however, *S. apella*, *S. macrocephalus*, and *S. cay* individuals were recovered in two geographic clades, from northeastern and southwestern Amazon, rather than clustering by currently defined morphospecies. STRUCTURE analysis of population clustering revealed widespread admixture among *Sapajus* populations within the Amazon and even into the Cerrado and Atlantic Forest. Difficulty in assigning species by morphology may be a result of widespread population admixture facilitated through frequent movement across major rivers and even ecosystems by robust capuchin monkeys.\n","tags":["Vertebrate phylogenetics","Divergence dating","UCEs"],"title":"A phylogenomic perspective on the robust capuchin monkey (Sapajus) radiation: First evidence for extensive population admixture across South America","type":"publication"},{"authors":["Michael E. Alfaro","Brant C. Faircloth","Richard C. Harrington","Laurie Sorenson","Matt Friedman","Christine E. Thacker","Carl H. Oliveros","David Černý","Thomas J. Near"],"categories":null,"content":"","date":1520812800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1520812800,"objectID":"c2d56f5c03e4f472cc0f60c5f1a070a9","permalink":"/publication/alfaro_et_al_2018/","publishdate":"2019-11-23T20:00:00Z","relpermalink":"/publication/alfaro_et_al_2018/","section":"publication","summary":"The Cretaceous–Palaeogene (K--Pg) mass extinction is linked to the rapid emergence of ecologically divergent higher taxa (for example, families and orders) across terrestrial vertebrates, but its impact on the diversification of marine vertebrates is less clear. Spiny-rayed fishes (Acanthomorpha) provide an ideal system for exploring the effects of the K–Pg on fish diversification, yet despite decades of morphological and molecular phylogenetic efforts, resolution of both early diverging lineages and enormously diverse subclades remains problematic. Recent multilocus studies have provided the first resolved phylogenetic backbone for acanthomorphs and suggested novel relationships among major lineages. However, these new relationships and associated timescales have not been interrogated using phylogenomic approaches. Here, we use targeted enrichment of 1,000 ultraconserved elements in conjunction with a divergence time analysis to resolve relationships among 120 major acanthomorph lineages and provide a new timescale for acanthomorph radiation. Our results include a well-supported topology that strongly resolves relationships along the acanthomorph backbone and the recovery of several new relationships within six major percomorph subclades. Divergence time analyses also reveal that crown ages for five of these subclades, and for the bulk of the species diversity in the sixth, coincide with the K–Pg boundary, with divergences between anatomically and ecologically distinctive suprafamilial clades concentrated in the first 10 million years of the Cenozoic. ","tags":["Vertebrate phylogenetics","Divergence dating","UCEs"],"title":"Explosive diversification of marine fishes at the Cretaceous–Palaeogene boundary","type":"publication"},{"authors":null,"categories":null,"content":"","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"d1311ddf745551c9e117aa4bb7e28516","permalink":"/project/external-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/external-project/","section":"project","summary":"An example of linking directly to an external project website using `external_link`.","tags":["Demo"],"title":"External Project","type":"project"},{"authors":null,"categories":null,"content":"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi. Cras purus urna, suscipit quis sapien eu, pulvinar tempor diam. Quisque risus orci, mollis id ante sit amet, gravida egestas nisl. Sed ac tempus magna. Proin in dui enim. Donec condimentum, sem id dapibus fringilla, tellus enim condimentum arcu, nec volutpat est felis vel metus. Vestibulum sit amet erat at nulla eleifend gravida.\nNullam vel molestie justo. Curabitur vitae efficitur leo. In hac habitasse platea dictumst. Sed pulvinar mauris dui, eget varius purus congue ac. Nulla euismod, lorem vel elementum dapibus, nunc justo porta mi, sed tempus est est vel tellus. Nam et enim eleifend, laoreet sem sit amet, elementum sem. Morbi ut leo congue, maximus velit ut, finibus arcu. In et libero cursus, rutrum risus non, molestie leo. Nullam congue quam et volutpat malesuada. Sed risus tortor, pulvinar et dictum nec, sodales non mi. Phasellus lacinia commodo laoreet. Nam mollis, erat in feugiat consectetur, purus eros egestas tellus, in auctor urna odio at nibh. Mauris imperdiet nisi ac magna convallis, at rhoncus ligula cursus.\nCras aliquam rhoncus ipsum, in hendrerit nunc mattis vitae. Duis vitae efficitur metus, ac tempus leo. Cras nec fringilla lacus. Quisque sit amet risus at ipsum pharetra commodo. Sed aliquam mauris at consequat eleifend. Praesent porta, augue sed viverra bibendum, neque ante euismod ante, in vehicula justo lorem ac eros. Suspendisse augue libero, venenatis eget tincidunt ut, malesuada at lorem. Donec vitae bibendum arcu. Aenean maximus nulla non pretium iaculis. Quisque imperdiet, nulla in pulvinar aliquet, velit quam ultrices quam, sit amet fringilla leo sem vel nunc. Mauris in lacinia lacus.\nSuspendisse a tincidunt lacus. Curabitur at urna sagittis, dictum ante sit amet, euismod magna. Sed rutrum massa id tortor commodo, vitae elementum turpis tempus. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aenean purus turpis, venenatis a ullamcorper nec, tincidunt et massa. Integer posuere quam rutrum arcu vehicula imperdiet. Mauris ullamcorper quam vitae purus congue, quis euismod magna eleifend. Vestibulum semper vel augue eget tincidunt. Fusce eget justo sodales, dapibus odio eu, ultrices lorem. Duis condimentum lorem id eros commodo, in facilisis mauris scelerisque. Morbi sed auctor leo. Nullam volutpat a lacus quis pharetra. Nulla congue rutrum magna a ornare.\nAliquam in turpis accumsan, malesuada nibh ut, hendrerit justo. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Quisque sed erat nec justo posuere suscipit. Donec ut efficitur arcu, in malesuada neque. Nunc dignissim nisl massa, id vulputate nunc pretium nec. Quisque eget urna in risus suscipit ultricies. Pellentesque odio odio, tincidunt in eleifend sed, posuere a diam. Nam gravida nisl convallis semper elementum. Morbi vitae felis faucibus, vulputate orci placerat, aliquet nisi. Aliquam erat volutpat. Maecenas sagittis pulvinar purus, sed porta quam laoreet at.\n","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"8f66d660a9a2edc2d08e68cc30f701f7","permalink":"/project/internal-project/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/internal-project/","section":"project","summary":"An example of using the in-built project page.","tags":["Deep Learning"],"title":"Internal Project","type":"project"}]